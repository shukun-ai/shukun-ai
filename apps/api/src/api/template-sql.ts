export const getTemplateSql = () =>
  `WITH B AS ( SELECT sale_name, ROUND(SUM(CASE WHEN sale_rate > standard_rate THEN sale_rate - standard_rate ELSE 0 END * amount), 2) AS commission_amount FROM gross_profit GROUP BY sale_name HAVING sale_name = '张旭' ), C AS ( SELECT sale_name, SUM(CASE WHEN invoice_type = '销售出库单' THEN day_30_amount ELSE 0 END) AS out_day_30_amount, SUM(CASE WHEN invoice_type = '销售出库单' THEN day_60_amount ELSE 0 END) AS out_day_60_amount, SUM(CASE WHEN invoice_type = '销售出库单' THEN day_90_amount ELSE 0 END) AS out_day_90_amount, SUM(CASE WHEN invoice_type = '销售出库单' THEN day_120_amount ELSE 0 END) AS out_day_120_amount, SUM(CASE WHEN invoice_type = '销售出库单' THEN day_more_than_120_amount ELSE 0 END) AS out_more_than_120_amount, SUM(CASE WHEN invoice_type = '销售发票' THEN day_30_amount ELSE 0 END) AS bill_day_30_amount, SUM(CASE WHEN invoice_type = '销售发票' THEN day_60_amount ELSE 0 END) AS bill_day_60_amount, SUM(CASE WHEN invoice_type = '销售发票' THEN day_90_amount ELSE 0 END) AS bill_day_90_amount, SUM(CASE WHEN invoice_type = '销售发票' THEN day_120_amount ELSE 0 END) AS bill_day_120_amount, SUM(CASE WHEN invoice_type = '销售发票' THEN day_more_than_120_amount ELSE 0 END) AS bill_more_than_120_amount FROM aging WHERE sale_name = '张旭' GROUP BY sale_name ), D AS ( SELECT sale_name, SUM(billing_amount) AS pre_sale_amount FROM aging WHERE invoice_type = '收款单(预收)' AND sale_name = '张旭' GROUP BY sale_name ), E AS ( SELECT C.sale_name, ROUND((C.out_day_30_amount * 30/365 * 0.05) + (C.out_day_60_amount * 60/365 * 0.05) + (C.out_day_90_amount * 90/365 * 0.05) + (C.out_day_120_amount * 120/365 * 0.05) + (C.out_more_than_120_amount * 150/365 * 0.05), 2) AS out_total_amount, ROUND((C.bill_day_30_amount * 30/365 * 0.05) + (C.bill_day_60_amount * 60/365 * 0.05) + (C.bill_day_90_amount * 90/365 * 0.05) + (C.bill_day_120_amount * 120/365 * 0.05) + (C.bill_more_than_120_amount * 150/365 * 0.05), 2) AS bill_total_amount, ROUND((D.pre_sale_amount * 30/365 * 0.05), 2) AS pre_sale_total_amount, ROUND((C.out_day_30_amount * 30/365 * 0.05) + (C.out_day_60_amount * 60/365 * 0.05) + (C.out_day_90_amount * 90/365 * 0.05) + (C.out_day_120_amount * 120/365 * 0.05) + (C.out_more_than_120_amount * 150/365 * 0.05) + (C.bill_day_30_amount * 30/365 * 0.05) + (C.bill_day_60_amount * 60/365 * 0.05) + (C.bill_day_90_amount * 90/365 * 0.05) + (C.bill_day_120_amount * 120/365 * 0.05) + (C.bill_more_than_120_amount * 150/365 * 0.05) + (D.pre_sale_amount * 30/365 * 0.05), 2) AS interest_amount FROM C LEFT JOIN D ON C.sale_name = D.sale_name ), F AS ( SELECT E.sale_name AS 姓名, B.commission_amount AS 佣金, E.interest_amount AS 利息成本, B.commission_amount - E.interest_amount AS 实付佣金, E.out_total_amount AS 出库未及时开票, E.bill_total_amount AS 开票未及时收款, E.pre_sale_total_amount AS 预收款节省利息 FROM E LEFT JOIN B ON E.sale_name = B.sale_name ) SELECT * FROM F WHERE 姓名 = '张旭'`;
